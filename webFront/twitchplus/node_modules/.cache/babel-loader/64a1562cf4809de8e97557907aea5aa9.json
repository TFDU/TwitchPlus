{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport Dialog from 'rc-dialog';\nimport RotateLeftOutlined from '@ant-design/icons/RotateLeftOutlined';\nimport RotateRightOutlined from '@ant-design/icons/RotateRightOutlined';\nimport ZoomInOutlined from '@ant-design/icons/ZoomInOutlined';\nimport ZoomOutOutlined from '@ant-design/icons/ZoomOutOutlined';\nimport CloseOutlined from '@ant-design/icons/CloseOutlined';\nimport LeftOutlined from '@ant-design/icons/LeftOutlined';\nimport RightOutlined from '@ant-design/icons/RightOutlined';\nimport classnames from 'classnames';\nimport addEventListener from \"rc-util/es/Dom/addEventListener\";\nimport { getOffset } from \"rc-util/es/Dom/css\";\nimport { warning } from \"rc-util/es/warning\";\nimport useFrameSetState from './hooks/useFrameSetState';\nimport usePreviewIndex from './hooks/usePreviewIndex';\nimport getFixScaleEleTransPosition from './getFixScaleEleTransPosition';\nimport { context } from './PreviewGroup';\nvar useState = React.useState;\nvar initialPosition = {\n  x: 0,\n  y: 0\n};\n\nvar Preview = function Preview(props) {\n  var prefixCls = props.prefixCls,\n      src = props.src,\n      alt = props.alt,\n      onClose = props.onClose,\n      afterClose = props.afterClose,\n      visible = props.visible,\n      restProps = _objectWithoutProperties(props, [\"prefixCls\", \"src\", \"alt\", \"onClose\", \"afterClose\", \"visible\"]);\n\n  var _useState = useState(1),\n      _useState2 = _slicedToArray(_useState, 2),\n      scale = _useState2[0],\n      setScale = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      rotate = _useState4[0],\n      setRotate = _useState4[1];\n\n  var _useFrameSetState = useFrameSetState(initialPosition),\n      _useFrameSetState2 = _slicedToArray(_useFrameSetState, 2),\n      position = _useFrameSetState2[0],\n      setPosition = _useFrameSetState2[1];\n\n  var imgRef = React.useRef();\n  var originPositionRef = React.useRef({\n    originX: 0,\n    originY: 0,\n    deltaX: 0,\n    deltaY: 0\n  });\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isMoving = _React$useState2[0],\n      setMoving = _React$useState2[1];\n\n  var _React$useContext = React.useContext(context),\n      previewUrls = _React$useContext.previewUrls;\n\n  var urls = previewUrls && previewUrls.length ? previewUrls : [src];\n\n  var _usePreviewIndex = usePreviewIndex(src, urls),\n      _usePreviewIndex2 = _slicedToArray(_usePreviewIndex, 2),\n      index = _usePreviewIndex2[0],\n      setIndex = _usePreviewIndex2[1];\n\n  var onAfterClose = function onAfterClose() {\n    setScale(1);\n    setRotate(0);\n    setPosition(initialPosition);\n  };\n\n  var onZoomIn = function onZoomIn() {\n    setScale(function (value) {\n      return value + 1;\n    });\n    setPosition(initialPosition);\n  };\n\n  var onZoomOut = function onZoomOut() {\n    if (scale > 1) {\n      setScale(function (value) {\n        return value - 1;\n      });\n    }\n\n    setPosition(initialPosition);\n  };\n\n  var onRotateRight = function onRotateRight() {\n    setRotate(function (value) {\n      return value + 90;\n    });\n  };\n\n  var onRotateLeft = function onRotateLeft() {\n    setRotate(function (value) {\n      return value - 90;\n    });\n  };\n\n  var onSwitchLeft = function onSwitchLeft(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n\n    if (index > 0) {\n      onAfterClose();\n      setIndex(index - 1);\n    }\n  };\n\n  var onSwitchRight = function onSwitchRight(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n\n    if (index < urls.length - 1) {\n      onAfterClose();\n      setIndex(index + 1);\n    }\n  };\n\n  var wrapClassName = classnames(_defineProperty({}, \"\".concat(prefixCls, \"-moving\"), isMoving));\n  var toolClassName = \"\".concat(prefixCls, \"-operations-operation\");\n  var iconClassName = \"\".concat(prefixCls, \"-operations-icon\");\n  var tools = [{\n    Icon: CloseOutlined,\n    onClick: onClose,\n    type: 'close'\n  }, {\n    Icon: ZoomInOutlined,\n    onClick: onZoomIn,\n    type: 'zoomIn'\n  }, {\n    Icon: ZoomOutOutlined,\n    onClick: onZoomOut,\n    type: 'zoomOut',\n    disabled: scale === 1\n  }, {\n    Icon: RotateRightOutlined,\n    onClick: onRotateRight,\n    type: 'rotateRight'\n  }, {\n    Icon: RotateLeftOutlined,\n    onClick: onRotateLeft,\n    type: 'rotateLeft'\n  }];\n\n  var onMouseUp = function onMouseUp() {\n    if (visible && isMoving) {\n      var width = imgRef.current.offsetWidth * scale;\n      var height = imgRef.current.offsetHeight * scale;\n\n      var _getOffset = getOffset(imgRef.current),\n          left = _getOffset.left,\n          top = _getOffset.top;\n\n      var isRotate = rotate % 180 !== 0;\n      setMoving(false);\n      var fixState = getFixScaleEleTransPosition(isRotate ? height : width, isRotate ? width : height, left, top);\n\n      if (fixState) {\n        setPosition(_objectSpread({}, fixState));\n      }\n    }\n  };\n\n  var onMouseDown = function onMouseDown(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n    originPositionRef.current.deltaX = event.pageX - position.x;\n    originPositionRef.current.deltaY = event.pageY - position.y;\n    originPositionRef.current.originX = position.x;\n    originPositionRef.current.originY = position.y;\n    setMoving(true);\n  };\n\n  var onMouseMove = function onMouseMove(event) {\n    if (visible && isMoving) {\n      setPosition({\n        x: event.pageX - originPositionRef.current.deltaX,\n        y: event.pageY - originPositionRef.current.deltaY\n      });\n    }\n  };\n\n  React.useEffect(function () {\n    var onTopMouseUpListener;\n    var onTopMouseMoveListener;\n    var onMouseUpListener = addEventListener(window, 'mouseup', onMouseUp, false);\n    var onMouseMoveListener = addEventListener(window, 'mousemove', onMouseMove, false);\n\n    try {\n      // Resolve if in iframe lost event\n\n      /* istanbul ignore next */\n      if (window.top !== window.self) {\n        onTopMouseUpListener = addEventListener(window.top, 'mouseup', onMouseUp, false);\n        onTopMouseMoveListener = addEventListener(window.top, 'mousemove', onMouseMove, false);\n      }\n    } catch (error) {\n      /* istanbul ignore next */\n      warning(false, \"[rc-image] \".concat(error));\n    }\n\n    return function () {\n      onMouseUpListener.remove();\n      onMouseMoveListener.remove();\n      /* istanbul ignore next */\n\n      if (onTopMouseUpListener) onTopMouseUpListener.remove();\n      /* istanbul ignore next */\n\n      if (onTopMouseMoveListener) onTopMouseMoveListener.remove();\n\n      if (!visible) {\n        setIndex(urls.indexOf(src));\n      }\n    };\n  }, [visible, isMoving]);\n  return /*#__PURE__*/React.createElement(Dialog, Object.assign({}, restProps, {\n    transitionName: \"zoom\",\n    maskTransitionName: \"fade\",\n    closable: false,\n    keyboard: true,\n    prefixCls: prefixCls,\n    onClose: onClose,\n    afterClose: onAfterClose,\n    visible: visible,\n    wrapClassName: wrapClassName\n  }), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"\".concat(prefixCls, \"-operations\")\n  }, tools.map(function (_ref) {\n    var Icon = _ref.Icon,\n        onClick = _ref.onClick,\n        type = _ref.type,\n        disabled = _ref.disabled;\n    return /*#__PURE__*/React.createElement(\"li\", {\n      className: classnames(toolClassName, _defineProperty({}, \"\".concat(prefixCls, \"-operations-operation-disabled\"), !!disabled)),\n      onClick: onClick,\n      key: type\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: iconClassName\n    }));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-img-wrapper\"),\n    style: {\n      transform: \"translate3d(\".concat(position.x, \"px, \").concat(position.y, \"px, 0)\")\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    onMouseDown: onMouseDown,\n    ref: imgRef,\n    className: \"\".concat(prefixCls, \"-img\"),\n    src: urls[index],\n    alt: alt,\n    style: {\n      transform: \"scale3d(\".concat(scale, \", \").concat(scale, \", 1) rotate(\").concat(rotate, \"deg)\")\n    }\n  })), urls.length > 1 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"\".concat(prefixCls, \"-switch-left\"), _defineProperty({}, \"\".concat(prefixCls, \"-switch-left-disabled\"), index <= 0)),\n    onClick: onSwitchLeft\n  }, /*#__PURE__*/React.createElement(LeftOutlined, null)) : null, urls.length > 1 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"\".concat(prefixCls, \"-switch-right\"), _defineProperty({}, \"\".concat(prefixCls, \"-switch-right-disabled\"), index >= urls.length - 1)),\n    onClick: onSwitchRight\n  }, /*#__PURE__*/React.createElement(RightOutlined, null)) : null);\n};\n\nexport default Preview;","map":{"version":3,"sources":["D:/projects/TwitchPlus/webFront/twitchplus/node_modules/rc-image/es/Preview.js"],"names":["_objectSpread","_defineProperty","_slicedToArray","_objectWithoutProperties","React","Dialog","RotateLeftOutlined","RotateRightOutlined","ZoomInOutlined","ZoomOutOutlined","CloseOutlined","LeftOutlined","RightOutlined","classnames","addEventListener","getOffset","warning","useFrameSetState","usePreviewIndex","getFixScaleEleTransPosition","context","useState","initialPosition","x","y","Preview","props","prefixCls","src","alt","onClose","afterClose","visible","restProps","_useState","_useState2","scale","setScale","_useState3","_useState4","rotate","setRotate","_useFrameSetState","_useFrameSetState2","position","setPosition","imgRef","useRef","originPositionRef","originX","originY","deltaX","deltaY","_React$useState","_React$useState2","isMoving","setMoving","_React$useContext","useContext","previewUrls","urls","length","_usePreviewIndex","_usePreviewIndex2","index","setIndex","onAfterClose","onZoomIn","value","onZoomOut","onRotateRight","onRotateLeft","onSwitchLeft","event","preventDefault","stopPropagation","onSwitchRight","wrapClassName","concat","toolClassName","iconClassName","tools","Icon","onClick","type","disabled","onMouseUp","width","current","offsetWidth","height","offsetHeight","_getOffset","left","top","isRotate","fixState","onMouseDown","pageX","pageY","onMouseMove","useEffect","onTopMouseUpListener","onTopMouseMoveListener","onMouseUpListener","window","onMouseMoveListener","self","error","remove","indexOf","createElement","Object","assign","transitionName","maskTransitionName","closable","keyboard","className","map","_ref","key","style","transform","ref"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport Dialog from 'rc-dialog';\nimport RotateLeftOutlined from '@ant-design/icons/RotateLeftOutlined';\nimport RotateRightOutlined from '@ant-design/icons/RotateRightOutlined';\nimport ZoomInOutlined from '@ant-design/icons/ZoomInOutlined';\nimport ZoomOutOutlined from '@ant-design/icons/ZoomOutOutlined';\nimport CloseOutlined from '@ant-design/icons/CloseOutlined';\nimport LeftOutlined from '@ant-design/icons/LeftOutlined';\nimport RightOutlined from '@ant-design/icons/RightOutlined';\nimport classnames from 'classnames';\nimport addEventListener from \"rc-util/es/Dom/addEventListener\";\nimport { getOffset } from \"rc-util/es/Dom/css\";\nimport { warning } from \"rc-util/es/warning\";\nimport useFrameSetState from './hooks/useFrameSetState';\nimport usePreviewIndex from './hooks/usePreviewIndex';\nimport getFixScaleEleTransPosition from './getFixScaleEleTransPosition';\nimport { context } from './PreviewGroup';\nvar useState = React.useState;\nvar initialPosition = {\n  x: 0,\n  y: 0\n};\n\nvar Preview = function Preview(props) {\n  var prefixCls = props.prefixCls,\n      src = props.src,\n      alt = props.alt,\n      onClose = props.onClose,\n      afterClose = props.afterClose,\n      visible = props.visible,\n      restProps = _objectWithoutProperties(props, [\"prefixCls\", \"src\", \"alt\", \"onClose\", \"afterClose\", \"visible\"]);\n\n  var _useState = useState(1),\n      _useState2 = _slicedToArray(_useState, 2),\n      scale = _useState2[0],\n      setScale = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      rotate = _useState4[0],\n      setRotate = _useState4[1];\n\n  var _useFrameSetState = useFrameSetState(initialPosition),\n      _useFrameSetState2 = _slicedToArray(_useFrameSetState, 2),\n      position = _useFrameSetState2[0],\n      setPosition = _useFrameSetState2[1];\n\n  var imgRef = React.useRef();\n  var originPositionRef = React.useRef({\n    originX: 0,\n    originY: 0,\n    deltaX: 0,\n    deltaY: 0\n  });\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isMoving = _React$useState2[0],\n      setMoving = _React$useState2[1];\n\n  var _React$useContext = React.useContext(context),\n      previewUrls = _React$useContext.previewUrls;\n\n  var urls = previewUrls && previewUrls.length ? previewUrls : [src];\n\n  var _usePreviewIndex = usePreviewIndex(src, urls),\n      _usePreviewIndex2 = _slicedToArray(_usePreviewIndex, 2),\n      index = _usePreviewIndex2[0],\n      setIndex = _usePreviewIndex2[1];\n\n  var onAfterClose = function onAfterClose() {\n    setScale(1);\n    setRotate(0);\n    setPosition(initialPosition);\n  };\n\n  var onZoomIn = function onZoomIn() {\n    setScale(function (value) {\n      return value + 1;\n    });\n    setPosition(initialPosition);\n  };\n\n  var onZoomOut = function onZoomOut() {\n    if (scale > 1) {\n      setScale(function (value) {\n        return value - 1;\n      });\n    }\n\n    setPosition(initialPosition);\n  };\n\n  var onRotateRight = function onRotateRight() {\n    setRotate(function (value) {\n      return value + 90;\n    });\n  };\n\n  var onRotateLeft = function onRotateLeft() {\n    setRotate(function (value) {\n      return value - 90;\n    });\n  };\n\n  var onSwitchLeft = function onSwitchLeft(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n\n    if (index > 0) {\n      onAfterClose();\n      setIndex(index - 1);\n    }\n  };\n\n  var onSwitchRight = function onSwitchRight(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n\n    if (index < urls.length - 1) {\n      onAfterClose();\n      setIndex(index + 1);\n    }\n  };\n\n  var wrapClassName = classnames(_defineProperty({}, \"\".concat(prefixCls, \"-moving\"), isMoving));\n  var toolClassName = \"\".concat(prefixCls, \"-operations-operation\");\n  var iconClassName = \"\".concat(prefixCls, \"-operations-icon\");\n  var tools = [{\n    Icon: CloseOutlined,\n    onClick: onClose,\n    type: 'close'\n  }, {\n    Icon: ZoomInOutlined,\n    onClick: onZoomIn,\n    type: 'zoomIn'\n  }, {\n    Icon: ZoomOutOutlined,\n    onClick: onZoomOut,\n    type: 'zoomOut',\n    disabled: scale === 1\n  }, {\n    Icon: RotateRightOutlined,\n    onClick: onRotateRight,\n    type: 'rotateRight'\n  }, {\n    Icon: RotateLeftOutlined,\n    onClick: onRotateLeft,\n    type: 'rotateLeft'\n  }];\n\n  var onMouseUp = function onMouseUp() {\n    if (visible && isMoving) {\n      var width = imgRef.current.offsetWidth * scale;\n      var height = imgRef.current.offsetHeight * scale;\n\n      var _getOffset = getOffset(imgRef.current),\n          left = _getOffset.left,\n          top = _getOffset.top;\n\n      var isRotate = rotate % 180 !== 0;\n      setMoving(false);\n      var fixState = getFixScaleEleTransPosition(isRotate ? height : width, isRotate ? width : height, left, top);\n\n      if (fixState) {\n        setPosition(_objectSpread({}, fixState));\n      }\n    }\n  };\n\n  var onMouseDown = function onMouseDown(event) {\n    event.preventDefault(); // Without this mask close will abnormal\n\n    event.stopPropagation();\n    originPositionRef.current.deltaX = event.pageX - position.x;\n    originPositionRef.current.deltaY = event.pageY - position.y;\n    originPositionRef.current.originX = position.x;\n    originPositionRef.current.originY = position.y;\n    setMoving(true);\n  };\n\n  var onMouseMove = function onMouseMove(event) {\n    if (visible && isMoving) {\n      setPosition({\n        x: event.pageX - originPositionRef.current.deltaX,\n        y: event.pageY - originPositionRef.current.deltaY\n      });\n    }\n  };\n\n  React.useEffect(function () {\n    var onTopMouseUpListener;\n    var onTopMouseMoveListener;\n    var onMouseUpListener = addEventListener(window, 'mouseup', onMouseUp, false);\n    var onMouseMoveListener = addEventListener(window, 'mousemove', onMouseMove, false);\n\n    try {\n      // Resolve if in iframe lost event\n\n      /* istanbul ignore next */\n      if (window.top !== window.self) {\n        onTopMouseUpListener = addEventListener(window.top, 'mouseup', onMouseUp, false);\n        onTopMouseMoveListener = addEventListener(window.top, 'mousemove', onMouseMove, false);\n      }\n    } catch (error) {\n      /* istanbul ignore next */\n      warning(false, \"[rc-image] \".concat(error));\n    }\n\n    return function () {\n      onMouseUpListener.remove();\n      onMouseMoveListener.remove();\n      /* istanbul ignore next */\n\n      if (onTopMouseUpListener) onTopMouseUpListener.remove();\n      /* istanbul ignore next */\n\n      if (onTopMouseMoveListener) onTopMouseMoveListener.remove();\n\n      if (!visible) {\n        setIndex(urls.indexOf(src));\n      }\n    };\n  }, [visible, isMoving]);\n  return /*#__PURE__*/React.createElement(Dialog, Object.assign({}, restProps, {\n    transitionName: \"zoom\",\n    maskTransitionName: \"fade\",\n    closable: false,\n    keyboard: true,\n    prefixCls: prefixCls,\n    onClose: onClose,\n    afterClose: onAfterClose,\n    visible: visible,\n    wrapClassName: wrapClassName\n  }), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"\".concat(prefixCls, \"-operations\")\n  }, tools.map(function (_ref) {\n    var Icon = _ref.Icon,\n        onClick = _ref.onClick,\n        type = _ref.type,\n        disabled = _ref.disabled;\n    return /*#__PURE__*/React.createElement(\"li\", {\n      className: classnames(toolClassName, _defineProperty({}, \"\".concat(prefixCls, \"-operations-operation-disabled\"), !!disabled)),\n      onClick: onClick,\n      key: type\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: iconClassName\n    }));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-img-wrapper\"),\n    style: {\n      transform: \"translate3d(\".concat(position.x, \"px, \").concat(position.y, \"px, 0)\")\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    onMouseDown: onMouseDown,\n    ref: imgRef,\n    className: \"\".concat(prefixCls, \"-img\"),\n    src: urls[index],\n    alt: alt,\n    style: {\n      transform: \"scale3d(\".concat(scale, \", \").concat(scale, \", 1) rotate(\").concat(rotate, \"deg)\")\n    }\n  })), urls.length > 1 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"\".concat(prefixCls, \"-switch-left\"), _defineProperty({}, \"\".concat(prefixCls, \"-switch-left-disabled\"), index <= 0)),\n    onClick: onSwitchLeft\n  }, /*#__PURE__*/React.createElement(LeftOutlined, null)) : null, urls.length > 1 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"\".concat(prefixCls, \"-switch-right\"), _defineProperty({}, \"\".concat(prefixCls, \"-switch-right-disabled\"), index >= urls.length - 1)),\n    onClick: onSwitchRight\n  }, /*#__PURE__*/React.createElement(RightOutlined, null)) : null);\n};\n\nexport default Preview;"]},"metadata":{},"sourceType":"module"}