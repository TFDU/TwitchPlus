{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { useState } from 'react';\nimport cn from 'classnames';\nimport { getOffset } from \"rc-util/es/Dom/css\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport Preview from './Preview';\nimport PreviewGroup, { context } from './PreviewGroup';\n\nvar ImageInternal = function ImageInternal(_ref) {\n  var src = _ref.src,\n      alt = _ref.alt,\n      onInitialPreviewClose = _ref.onPreviewClose,\n      _ref$prefixCls = _ref.prefixCls,\n      prefixCls = _ref$prefixCls === void 0 ? 'rc-image' : _ref$prefixCls,\n      _ref$previewPrefixCls = _ref.previewPrefixCls,\n      previewPrefixCls = _ref$previewPrefixCls === void 0 ? \"\".concat(prefixCls, \"-preview\") : _ref$previewPrefixCls,\n      placeholder = _ref.placeholder,\n      fallback = _ref.fallback,\n      width = _ref.width,\n      height = _ref.height,\n      style = _ref.style,\n      _ref$preview = _ref.preview,\n      preview = _ref$preview === void 0 ? true : _ref$preview,\n      className = _ref.className,\n      onClick = _ref.onClick,\n      wrapperClassName = _ref.wrapperClassName,\n      wrapperStyle = _ref.wrapperStyle,\n      crossOrigin = _ref.crossOrigin,\n      decoding = _ref.decoding,\n      loading = _ref.loading,\n      referrerPolicy = _ref.referrerPolicy,\n      sizes = _ref.sizes,\n      srcSet = _ref.srcSet,\n      useMap = _ref.useMap,\n      otherProps = _objectWithoutProperties(_ref, [\"src\", \"alt\", \"onPreviewClose\", \"prefixCls\", \"previewPrefixCls\", \"placeholder\", \"fallback\", \"width\", \"height\", \"style\", \"preview\", \"className\", \"onClick\", \"wrapperClassName\", \"wrapperStyle\", \"crossOrigin\", \"decoding\", \"loading\", \"referrerPolicy\", \"sizes\", \"srcSet\", \"useMap\"]);\n\n  var isCustomPlaceholder = placeholder && placeholder !== true;\n\n  var _ref2 = _typeof(preview) === 'object' ? preview : {},\n      _ref2$visible = _ref2.visible,\n      visible = _ref2$visible === void 0 ? undefined : _ref2$visible,\n      _ref2$onVisibleChange = _ref2.onVisibleChange,\n      onVisibleChange = _ref2$onVisibleChange === void 0 ? onInitialPreviewClose : _ref2$onVisibleChange,\n      _ref2$getContainer = _ref2.getContainer,\n      getContainer = _ref2$getContainer === void 0 ? undefined : _ref2$getContainer;\n\n  var isControlled = visible !== undefined;\n\n  var _useMergedState = useMergedState(!!visible, {\n    value: visible,\n    onChange: onVisibleChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      isShowPreview = _useMergedState2[0],\n      setShowPreview = _useMergedState2[1];\n\n  var _useState = useState(isCustomPlaceholder ? 'loading' : 'normal'),\n      _useState2 = _slicedToArray(_useState, 2),\n      status = _useState2[0],\n      setStatus = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      mousePosition = _useState4[0],\n      setMousePosition = _useState4[1];\n\n  var isError = status === 'error';\n\n  var _React$useContext = React.useContext(context),\n      isPreviewGroup = _React$useContext.isPreviewGroup,\n      previewUrls = _React$useContext.previewUrls,\n      setPreviewUrls = _React$useContext.setPreviewUrls,\n      setCurrent = _React$useContext.setCurrent,\n      setGroupShowPreview = _React$useContext.setShowPreview,\n      setGroupMousePosition = _React$useContext.setMousePosition;\n\n  var groupIndexRef = React.useRef(0);\n\n  var onLoad = function onLoad() {\n    setStatus('normal');\n  };\n\n  var onError = function onError() {\n    setStatus('error');\n\n    if (isPreviewGroup) {\n      previewUrls.splice(groupIndexRef.current);\n      setPreviewUrls(previewUrls);\n    }\n  };\n\n  var onPreview = function onPreview(e) {\n    if (!isControlled) {\n      var _getOffset = getOffset(e.target),\n          left = _getOffset.left,\n          top = _getOffset.top;\n\n      if (isPreviewGroup) {\n        setCurrent(src);\n        setGroupMousePosition({\n          x: left,\n          y: top\n        });\n      } else {\n        setMousePosition({\n          x: left,\n          y: top\n        });\n      }\n    }\n\n    if (isPreviewGroup) {\n      setGroupShowPreview(true);\n    } else {\n      setShowPreview(true);\n    }\n\n    if (onClick) onClick(e);\n  };\n\n  var onPreviewClose = function onPreviewClose(e) {\n    e.stopPropagation();\n    setShowPreview(false);\n\n    if (!isControlled) {\n      setMousePosition(null);\n    }\n  };\n\n  var getImgRef = function getImgRef(img) {\n    if (status !== 'loading') return;\n\n    if ((img === null || img === void 0 ? void 0 : img.complete) && (img.naturalWidth || img.naturalHeight)) {\n      onLoad();\n    }\n  };\n\n  React.useEffect(function () {\n    if (isPreviewGroup && previewUrls.indexOf(src) < 0) {\n      groupIndexRef.current = previewUrls.length;\n      previewUrls.push(src);\n      setPreviewUrls(previewUrls);\n    }\n  }, [previewUrls]);\n  React.useEffect(function () {\n    if (isCustomPlaceholder) {\n      setStatus('loading');\n    }\n\n    return function () {\n      setPreviewUrls(previewUrls.filter(function (url) {\n        return url !== src;\n      }));\n    };\n  }, [src]);\n  var wrappperClass = cn(prefixCls, wrapperClassName, _defineProperty({}, \"\".concat(prefixCls, \"-error\"), isError));\n  var mergedSrc = isError && fallback ? fallback : src;\n  var imgCommonProps = {\n    crossOrigin: crossOrigin,\n    decoding: decoding,\n    loading: loading,\n    referrerPolicy: referrerPolicy,\n    sizes: sizes,\n    srcSet: srcSet,\n    useMap: useMap,\n    alt: alt,\n    className: cn(\"\".concat(prefixCls, \"-img\"), _defineProperty({}, \"\".concat(prefixCls, \"-img-placeholder\"), placeholder === true), className),\n    style: _objectSpread({\n      height: height\n    }, style)\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", Object.assign({}, otherProps, {\n    className: wrappperClass,\n    onClick: preview && !isError ? onPreview : onClick,\n    style: _objectSpread({\n      width: width,\n      height: height\n    }, wrapperStyle)\n  }), isError && fallback ? /*#__PURE__*/React.createElement(\"img\", Object.assign({}, imgCommonProps, {\n    src: fallback\n  })) : /*#__PURE__*/React.createElement(\"img\", Object.assign({}, imgCommonProps, {\n    onLoad: onLoad,\n    onError: onError,\n    src: src,\n    ref: getImgRef\n  })), status === 'loading' && /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-hidden\": \"true\",\n    className: \"\".concat(prefixCls, \"-placeholder\")\n  }, placeholder)), !isPreviewGroup && preview && !isError && /*#__PURE__*/React.createElement(Preview, {\n    \"aria-hidden\": !isShowPreview,\n    visible: isShowPreview,\n    prefixCls: previewPrefixCls,\n    onClose: onPreviewClose,\n    mousePosition: mousePosition,\n    src: mergedSrc,\n    alt: alt,\n    getContainer: getContainer\n  }));\n};\n\nImageInternal.PreviewGroup = PreviewGroup;\nImageInternal.displayName = 'Image';\nexport default ImageInternal;","map":{"version":3,"sources":["D:/projects/TwitchPlus/webFront/twitchplus/node_modules/rc-image/es/Image.js"],"names":["_objectSpread","_defineProperty","_slicedToArray","_typeof","_objectWithoutProperties","React","useState","cn","getOffset","useMergedState","Preview","PreviewGroup","context","ImageInternal","_ref","src","alt","onInitialPreviewClose","onPreviewClose","_ref$prefixCls","prefixCls","_ref$previewPrefixCls","previewPrefixCls","concat","placeholder","fallback","width","height","style","_ref$preview","preview","className","onClick","wrapperClassName","wrapperStyle","crossOrigin","decoding","loading","referrerPolicy","sizes","srcSet","useMap","otherProps","isCustomPlaceholder","_ref2","_ref2$visible","visible","undefined","_ref2$onVisibleChange","onVisibleChange","_ref2$getContainer","getContainer","isControlled","_useMergedState","value","onChange","_useMergedState2","isShowPreview","setShowPreview","_useState","_useState2","status","setStatus","_useState3","_useState4","mousePosition","setMousePosition","isError","_React$useContext","useContext","isPreviewGroup","previewUrls","setPreviewUrls","setCurrent","setGroupShowPreview","setGroupMousePosition","groupIndexRef","useRef","onLoad","onError","splice","current","onPreview","e","_getOffset","target","left","top","x","y","stopPropagation","getImgRef","img","complete","naturalWidth","naturalHeight","useEffect","indexOf","length","push","filter","url","wrappperClass","mergedSrc","imgCommonProps","createElement","Fragment","Object","assign","ref","onClose","displayName"],"mappings":"AAAA,OAAOA,aAAP,MAA0B,0CAA1B;AACA,OAAOC,eAAP,MAA4B,2CAA5B;AACA,OAAOC,cAAP,MAA2B,0CAA3B;AACA,OAAOC,OAAP,MAAoB,mCAApB;AACA,OAAOC,wBAAP,MAAqC,oDAArC;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,SAAT,QAA0B,oBAA1B;AACA,OAAOC,cAAP,MAA2B,iCAA3B;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,YAAP,IAAuBC,OAAvB,QAAsC,gBAAtC;;AAEA,IAAIC,aAAa,GAAG,SAASA,aAAT,CAAuBC,IAAvB,EAA6B;AAC/C,MAAIC,GAAG,GAAGD,IAAI,CAACC,GAAf;AAAA,MACIC,GAAG,GAAGF,IAAI,CAACE,GADf;AAAA,MAEIC,qBAAqB,GAAGH,IAAI,CAACI,cAFjC;AAAA,MAGIC,cAAc,GAAGL,IAAI,CAACM,SAH1B;AAAA,MAIIA,SAAS,GAAGD,cAAc,KAAK,KAAK,CAAxB,GAA4B,UAA5B,GAAyCA,cAJzD;AAAA,MAKIE,qBAAqB,GAAGP,IAAI,CAACQ,gBALjC;AAAA,MAMIA,gBAAgB,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC,GAAGE,MAAH,CAAUH,SAAV,EAAqB,UAArB,CAAnC,GAAsEC,qBAN7F;AAAA,MAOIG,WAAW,GAAGV,IAAI,CAACU,WAPvB;AAAA,MAQIC,QAAQ,GAAGX,IAAI,CAACW,QARpB;AAAA,MASIC,KAAK,GAAGZ,IAAI,CAACY,KATjB;AAAA,MAUIC,MAAM,GAAGb,IAAI,CAACa,MAVlB;AAAA,MAWIC,KAAK,GAAGd,IAAI,CAACc,KAXjB;AAAA,MAYIC,YAAY,GAAGf,IAAI,CAACgB,OAZxB;AAAA,MAaIA,OAAO,GAAGD,YAAY,KAAK,KAAK,CAAtB,GAA0B,IAA1B,GAAiCA,YAb/C;AAAA,MAcIE,SAAS,GAAGjB,IAAI,CAACiB,SAdrB;AAAA,MAeIC,OAAO,GAAGlB,IAAI,CAACkB,OAfnB;AAAA,MAgBIC,gBAAgB,GAAGnB,IAAI,CAACmB,gBAhB5B;AAAA,MAiBIC,YAAY,GAAGpB,IAAI,CAACoB,YAjBxB;AAAA,MAkBIC,WAAW,GAAGrB,IAAI,CAACqB,WAlBvB;AAAA,MAmBIC,QAAQ,GAAGtB,IAAI,CAACsB,QAnBpB;AAAA,MAoBIC,OAAO,GAAGvB,IAAI,CAACuB,OApBnB;AAAA,MAqBIC,cAAc,GAAGxB,IAAI,CAACwB,cArB1B;AAAA,MAsBIC,KAAK,GAAGzB,IAAI,CAACyB,KAtBjB;AAAA,MAuBIC,MAAM,GAAG1B,IAAI,CAAC0B,MAvBlB;AAAA,MAwBIC,MAAM,GAAG3B,IAAI,CAAC2B,MAxBlB;AAAA,MAyBIC,UAAU,GAAGtC,wBAAwB,CAACU,IAAD,EAAO,CAAC,KAAD,EAAQ,KAAR,EAAe,gBAAf,EAAiC,WAAjC,EAA8C,kBAA9C,EAAkE,aAAlE,EAAiF,UAAjF,EAA6F,OAA7F,EAAsG,QAAtG,EAAgH,OAAhH,EAAyH,SAAzH,EAAoI,WAApI,EAAiJ,SAAjJ,EAA4J,kBAA5J,EAAgL,cAAhL,EAAgM,aAAhM,EAA+M,UAA/M,EAA2N,SAA3N,EAAsO,gBAAtO,EAAwP,OAAxP,EAAiQ,QAAjQ,EAA2Q,QAA3Q,CAAP,CAzBzC;;AA2BA,MAAI6B,mBAAmB,GAAGnB,WAAW,IAAIA,WAAW,KAAK,IAAzD;;AAEA,MAAIoB,KAAK,GAAGzC,OAAO,CAAC2B,OAAD,CAAP,KAAqB,QAArB,GAAgCA,OAAhC,GAA0C,EAAtD;AAAA,MACIe,aAAa,GAAGD,KAAK,CAACE,OAD1B;AAAA,MAEIA,OAAO,GAAGD,aAAa,KAAK,KAAK,CAAvB,GAA2BE,SAA3B,GAAuCF,aAFrD;AAAA,MAGIG,qBAAqB,GAAGJ,KAAK,CAACK,eAHlC;AAAA,MAIIA,eAAe,GAAGD,qBAAqB,KAAK,KAAK,CAA/B,GAAmC/B,qBAAnC,GAA2D+B,qBAJjF;AAAA,MAKIE,kBAAkB,GAAGN,KAAK,CAACO,YAL/B;AAAA,MAMIA,YAAY,GAAGD,kBAAkB,KAAK,KAAK,CAA5B,GAAgCH,SAAhC,GAA4CG,kBAN/D;;AAQA,MAAIE,YAAY,GAAGN,OAAO,KAAKC,SAA/B;;AAEA,MAAIM,eAAe,GAAG5C,cAAc,CAAC,CAAC,CAACqC,OAAH,EAAY;AAC9CQ,IAAAA,KAAK,EAAER,OADuC;AAE9CS,IAAAA,QAAQ,EAAEN;AAFoC,GAAZ,CAApC;AAAA,MAIIO,gBAAgB,GAAGtD,cAAc,CAACmD,eAAD,EAAkB,CAAlB,CAJrC;AAAA,MAKII,aAAa,GAAGD,gBAAgB,CAAC,CAAD,CALpC;AAAA,MAMIE,cAAc,GAAGF,gBAAgB,CAAC,CAAD,CANrC;;AAQA,MAAIG,SAAS,GAAGrD,QAAQ,CAACqC,mBAAmB,GAAG,SAAH,GAAe,QAAnC,CAAxB;AAAA,MACIiB,UAAU,GAAG1D,cAAc,CAACyD,SAAD,EAAY,CAAZ,CAD/B;AAAA,MAEIE,MAAM,GAAGD,UAAU,CAAC,CAAD,CAFvB;AAAA,MAGIE,SAAS,GAAGF,UAAU,CAAC,CAAD,CAH1B;;AAKA,MAAIG,UAAU,GAAGzD,QAAQ,CAAC,IAAD,CAAzB;AAAA,MACI0D,UAAU,GAAG9D,cAAc,CAAC6D,UAAD,EAAa,CAAb,CAD/B;AAAA,MAEIE,aAAa,GAAGD,UAAU,CAAC,CAAD,CAF9B;AAAA,MAGIE,gBAAgB,GAAGF,UAAU,CAAC,CAAD,CAHjC;;AAKA,MAAIG,OAAO,GAAGN,MAAM,KAAK,OAAzB;;AAEA,MAAIO,iBAAiB,GAAG/D,KAAK,CAACgE,UAAN,CAAiBzD,OAAjB,CAAxB;AAAA,MACI0D,cAAc,GAAGF,iBAAiB,CAACE,cADvC;AAAA,MAEIC,WAAW,GAAGH,iBAAiB,CAACG,WAFpC;AAAA,MAGIC,cAAc,GAAGJ,iBAAiB,CAACI,cAHvC;AAAA,MAIIC,UAAU,GAAGL,iBAAiB,CAACK,UAJnC;AAAA,MAKIC,mBAAmB,GAAGN,iBAAiB,CAACV,cAL5C;AAAA,MAMIiB,qBAAqB,GAAGP,iBAAiB,CAACF,gBAN9C;;AAQA,MAAIU,aAAa,GAAGvE,KAAK,CAACwE,MAAN,CAAa,CAAb,CAApB;;AAEA,MAAIC,MAAM,GAAG,SAASA,MAAT,GAAkB;AAC7BhB,IAAAA,SAAS,CAAC,QAAD,CAAT;AACD,GAFD;;AAIA,MAAIiB,OAAO,GAAG,SAASA,OAAT,GAAmB;AAC/BjB,IAAAA,SAAS,CAAC,OAAD,CAAT;;AAEA,QAAIQ,cAAJ,EAAoB;AAClBC,MAAAA,WAAW,CAACS,MAAZ,CAAmBJ,aAAa,CAACK,OAAjC;AACAT,MAAAA,cAAc,CAACD,WAAD,CAAd;AACD;AACF,GAPD;;AASA,MAAIW,SAAS,GAAG,SAASA,SAAT,CAAmBC,CAAnB,EAAsB;AACpC,QAAI,CAAC/B,YAAL,EAAmB;AACjB,UAAIgC,UAAU,GAAG5E,SAAS,CAAC2E,CAAC,CAACE,MAAH,CAA1B;AAAA,UACIC,IAAI,GAAGF,UAAU,CAACE,IADtB;AAAA,UAEIC,GAAG,GAAGH,UAAU,CAACG,GAFrB;;AAIA,UAAIjB,cAAJ,EAAoB;AAClBG,QAAAA,UAAU,CAAC1D,GAAD,CAAV;AACA4D,QAAAA,qBAAqB,CAAC;AACpBa,UAAAA,CAAC,EAAEF,IADiB;AAEpBG,UAAAA,CAAC,EAAEF;AAFiB,SAAD,CAArB;AAID,OAND,MAMO;AACLrB,QAAAA,gBAAgB,CAAC;AACfsB,UAAAA,CAAC,EAAEF,IADY;AAEfG,UAAAA,CAAC,EAAEF;AAFY,SAAD,CAAhB;AAID;AACF;;AAED,QAAIjB,cAAJ,EAAoB;AAClBI,MAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD,KAFD,MAEO;AACLhB,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD;;AAED,QAAI1B,OAAJ,EAAaA,OAAO,CAACmD,CAAD,CAAP;AACd,GA3BD;;AA6BA,MAAIjE,cAAc,GAAG,SAASA,cAAT,CAAwBiE,CAAxB,EAA2B;AAC9CA,IAAAA,CAAC,CAACO,eAAF;AACAhC,IAAAA,cAAc,CAAC,KAAD,CAAd;;AAEA,QAAI,CAACN,YAAL,EAAmB;AACjBc,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD;AACF,GAPD;;AASA,MAAIyB,SAAS,GAAG,SAASA,SAAT,CAAmBC,GAAnB,EAAwB;AACtC,QAAI/B,MAAM,KAAK,SAAf,EAA0B;;AAE1B,QAAI,CAAC+B,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAK,KAAK,CAA7B,GAAiC,KAAK,CAAtC,GAA0CA,GAAG,CAACC,QAA/C,MAA6DD,GAAG,CAACE,YAAJ,IAAoBF,GAAG,CAACG,aAArF,CAAJ,EAAyG;AACvGjB,MAAAA,MAAM;AACP;AACF,GAND;;AAQAzE,EAAAA,KAAK,CAAC2F,SAAN,CAAgB,YAAY;AAC1B,QAAI1B,cAAc,IAAIC,WAAW,CAAC0B,OAAZ,CAAoBlF,GAApB,IAA2B,CAAjD,EAAoD;AAClD6D,MAAAA,aAAa,CAACK,OAAd,GAAwBV,WAAW,CAAC2B,MAApC;AACA3B,MAAAA,WAAW,CAAC4B,IAAZ,CAAiBpF,GAAjB;AACAyD,MAAAA,cAAc,CAACD,WAAD,CAAd;AACD;AACF,GAND,EAMG,CAACA,WAAD,CANH;AAOAlE,EAAAA,KAAK,CAAC2F,SAAN,CAAgB,YAAY;AAC1B,QAAIrD,mBAAJ,EAAyB;AACvBmB,MAAAA,SAAS,CAAC,SAAD,CAAT;AACD;;AAED,WAAO,YAAY;AACjBU,MAAAA,cAAc,CAACD,WAAW,CAAC6B,MAAZ,CAAmB,UAAUC,GAAV,EAAe;AAC/C,eAAOA,GAAG,KAAKtF,GAAf;AACD,OAFc,CAAD,CAAd;AAGD,KAJD;AAKD,GAVD,EAUG,CAACA,GAAD,CAVH;AAWA,MAAIuF,aAAa,GAAG/F,EAAE,CAACa,SAAD,EAAYa,gBAAZ,EAA8BhC,eAAe,CAAC,EAAD,EAAK,GAAGsB,MAAH,CAAUH,SAAV,EAAqB,QAArB,CAAL,EAAqC+C,OAArC,CAA7C,CAAtB;AACA,MAAIoC,SAAS,GAAGpC,OAAO,IAAI1C,QAAX,GAAsBA,QAAtB,GAAiCV,GAAjD;AACA,MAAIyF,cAAc,GAAG;AACnBrE,IAAAA,WAAW,EAAEA,WADM;AAEnBC,IAAAA,QAAQ,EAAEA,QAFS;AAGnBC,IAAAA,OAAO,EAAEA,OAHU;AAInBC,IAAAA,cAAc,EAAEA,cAJG;AAKnBC,IAAAA,KAAK,EAAEA,KALY;AAMnBC,IAAAA,MAAM,EAAEA,MANW;AAOnBC,IAAAA,MAAM,EAAEA,MAPW;AAQnBzB,IAAAA,GAAG,EAAEA,GARc;AASnBe,IAAAA,SAAS,EAAExB,EAAE,CAAC,GAAGgB,MAAH,CAAUH,SAAV,EAAqB,MAArB,CAAD,EAA+BnB,eAAe,CAAC,EAAD,EAAK,GAAGsB,MAAH,CAAUH,SAAV,EAAqB,kBAArB,CAAL,EAA+CI,WAAW,KAAK,IAA/D,CAA9C,EAAoHO,SAApH,CATM;AAUnBH,IAAAA,KAAK,EAAE5B,aAAa,CAAC;AACnB2B,MAAAA,MAAM,EAAEA;AADW,KAAD,EAEjBC,KAFiB;AAVD,GAArB;AAcA,SAAO,aAAavB,KAAK,CAACoG,aAAN,CAAoBpG,KAAK,CAACqG,QAA1B,EAAoC,IAApC,EAA0C,aAAarG,KAAK,CAACoG,aAAN,CAAoB,KAApB,EAA2BE,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBlE,UAAlB,EAA8B;AAClIX,IAAAA,SAAS,EAAEuE,aADuH;AAElItE,IAAAA,OAAO,EAAEF,OAAO,IAAI,CAACqC,OAAZ,GAAsBe,SAAtB,GAAkClD,OAFuF;AAGlIJ,IAAAA,KAAK,EAAE5B,aAAa,CAAC;AACnB0B,MAAAA,KAAK,EAAEA,KADY;AAEnBC,MAAAA,MAAM,EAAEA;AAFW,KAAD,EAGjBO,YAHiB;AAH8G,GAA9B,CAA3B,EAOvEiC,OAAO,IAAI1C,QAAX,GAAsB,aAAapB,KAAK,CAACoG,aAAN,CAAoB,KAApB,EAA2BE,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBJ,cAAlB,EAAkC;AAClGzF,IAAAA,GAAG,EAAEU;AAD6F,GAAlC,CAA3B,CAAnC,GAEE,aAAapB,KAAK,CAACoG,aAAN,CAAoB,KAApB,EAA2BE,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBJ,cAAlB,EAAkC;AAC9E1B,IAAAA,MAAM,EAAEA,MADsE;AAE9EC,IAAAA,OAAO,EAAEA,OAFqE;AAG9EhE,IAAAA,GAAG,EAAEA,GAHyE;AAI9E8F,IAAAA,GAAG,EAAElB;AAJyE,GAAlC,CAA3B,CATwD,EActE9B,MAAM,KAAK,SAAX,IAAwB,aAAaxD,KAAK,CAACoG,aAAN,CAAoB,KAApB,EAA2B;AACnE,mBAAe,MADoD;AAEnE1E,IAAAA,SAAS,EAAE,GAAGR,MAAH,CAAUH,SAAV,EAAqB,cAArB;AAFwD,GAA3B,EAGvCI,WAHuC,CAdiC,CAAvD,EAiBF,CAAC8C,cAAD,IAAmBxC,OAAnB,IAA8B,CAACqC,OAA/B,IAA0C,aAAa9D,KAAK,CAACoG,aAAN,CAAoB/F,OAApB,EAA6B;AACpG,mBAAe,CAAC+C,aADoF;AAEpGX,IAAAA,OAAO,EAAEW,aAF2F;AAGpGrC,IAAAA,SAAS,EAAEE,gBAHyF;AAIpGwF,IAAAA,OAAO,EAAE5F,cAJ2F;AAKpG+C,IAAAA,aAAa,EAAEA,aALqF;AAMpGlD,IAAAA,GAAG,EAAEwF,SAN+F;AAOpGvF,IAAAA,GAAG,EAAEA,GAP+F;AAQpGmC,IAAAA,YAAY,EAAEA;AARsF,GAA7B,CAjBrD,CAApB;AA2BD,CA9LD;;AAgMAtC,aAAa,CAACF,YAAd,GAA6BA,YAA7B;AACAE,aAAa,CAACkG,WAAd,GAA4B,OAA5B;AACA,eAAelG,aAAf","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { useState } from 'react';\nimport cn from 'classnames';\nimport { getOffset } from \"rc-util/es/Dom/css\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport Preview from './Preview';\nimport PreviewGroup, { context } from './PreviewGroup';\n\nvar ImageInternal = function ImageInternal(_ref) {\n  var src = _ref.src,\n      alt = _ref.alt,\n      onInitialPreviewClose = _ref.onPreviewClose,\n      _ref$prefixCls = _ref.prefixCls,\n      prefixCls = _ref$prefixCls === void 0 ? 'rc-image' : _ref$prefixCls,\n      _ref$previewPrefixCls = _ref.previewPrefixCls,\n      previewPrefixCls = _ref$previewPrefixCls === void 0 ? \"\".concat(prefixCls, \"-preview\") : _ref$previewPrefixCls,\n      placeholder = _ref.placeholder,\n      fallback = _ref.fallback,\n      width = _ref.width,\n      height = _ref.height,\n      style = _ref.style,\n      _ref$preview = _ref.preview,\n      preview = _ref$preview === void 0 ? true : _ref$preview,\n      className = _ref.className,\n      onClick = _ref.onClick,\n      wrapperClassName = _ref.wrapperClassName,\n      wrapperStyle = _ref.wrapperStyle,\n      crossOrigin = _ref.crossOrigin,\n      decoding = _ref.decoding,\n      loading = _ref.loading,\n      referrerPolicy = _ref.referrerPolicy,\n      sizes = _ref.sizes,\n      srcSet = _ref.srcSet,\n      useMap = _ref.useMap,\n      otherProps = _objectWithoutProperties(_ref, [\"src\", \"alt\", \"onPreviewClose\", \"prefixCls\", \"previewPrefixCls\", \"placeholder\", \"fallback\", \"width\", \"height\", \"style\", \"preview\", \"className\", \"onClick\", \"wrapperClassName\", \"wrapperStyle\", \"crossOrigin\", \"decoding\", \"loading\", \"referrerPolicy\", \"sizes\", \"srcSet\", \"useMap\"]);\n\n  var isCustomPlaceholder = placeholder && placeholder !== true;\n\n  var _ref2 = _typeof(preview) === 'object' ? preview : {},\n      _ref2$visible = _ref2.visible,\n      visible = _ref2$visible === void 0 ? undefined : _ref2$visible,\n      _ref2$onVisibleChange = _ref2.onVisibleChange,\n      onVisibleChange = _ref2$onVisibleChange === void 0 ? onInitialPreviewClose : _ref2$onVisibleChange,\n      _ref2$getContainer = _ref2.getContainer,\n      getContainer = _ref2$getContainer === void 0 ? undefined : _ref2$getContainer;\n\n  var isControlled = visible !== undefined;\n\n  var _useMergedState = useMergedState(!!visible, {\n    value: visible,\n    onChange: onVisibleChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      isShowPreview = _useMergedState2[0],\n      setShowPreview = _useMergedState2[1];\n\n  var _useState = useState(isCustomPlaceholder ? 'loading' : 'normal'),\n      _useState2 = _slicedToArray(_useState, 2),\n      status = _useState2[0],\n      setStatus = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      mousePosition = _useState4[0],\n      setMousePosition = _useState4[1];\n\n  var isError = status === 'error';\n\n  var _React$useContext = React.useContext(context),\n      isPreviewGroup = _React$useContext.isPreviewGroup,\n      previewUrls = _React$useContext.previewUrls,\n      setPreviewUrls = _React$useContext.setPreviewUrls,\n      setCurrent = _React$useContext.setCurrent,\n      setGroupShowPreview = _React$useContext.setShowPreview,\n      setGroupMousePosition = _React$useContext.setMousePosition;\n\n  var groupIndexRef = React.useRef(0);\n\n  var onLoad = function onLoad() {\n    setStatus('normal');\n  };\n\n  var onError = function onError() {\n    setStatus('error');\n\n    if (isPreviewGroup) {\n      previewUrls.splice(groupIndexRef.current);\n      setPreviewUrls(previewUrls);\n    }\n  };\n\n  var onPreview = function onPreview(e) {\n    if (!isControlled) {\n      var _getOffset = getOffset(e.target),\n          left = _getOffset.left,\n          top = _getOffset.top;\n\n      if (isPreviewGroup) {\n        setCurrent(src);\n        setGroupMousePosition({\n          x: left,\n          y: top\n        });\n      } else {\n        setMousePosition({\n          x: left,\n          y: top\n        });\n      }\n    }\n\n    if (isPreviewGroup) {\n      setGroupShowPreview(true);\n    } else {\n      setShowPreview(true);\n    }\n\n    if (onClick) onClick(e);\n  };\n\n  var onPreviewClose = function onPreviewClose(e) {\n    e.stopPropagation();\n    setShowPreview(false);\n\n    if (!isControlled) {\n      setMousePosition(null);\n    }\n  };\n\n  var getImgRef = function getImgRef(img) {\n    if (status !== 'loading') return;\n\n    if ((img === null || img === void 0 ? void 0 : img.complete) && (img.naturalWidth || img.naturalHeight)) {\n      onLoad();\n    }\n  };\n\n  React.useEffect(function () {\n    if (isPreviewGroup && previewUrls.indexOf(src) < 0) {\n      groupIndexRef.current = previewUrls.length;\n      previewUrls.push(src);\n      setPreviewUrls(previewUrls);\n    }\n  }, [previewUrls]);\n  React.useEffect(function () {\n    if (isCustomPlaceholder) {\n      setStatus('loading');\n    }\n\n    return function () {\n      setPreviewUrls(previewUrls.filter(function (url) {\n        return url !== src;\n      }));\n    };\n  }, [src]);\n  var wrappperClass = cn(prefixCls, wrapperClassName, _defineProperty({}, \"\".concat(prefixCls, \"-error\"), isError));\n  var mergedSrc = isError && fallback ? fallback : src;\n  var imgCommonProps = {\n    crossOrigin: crossOrigin,\n    decoding: decoding,\n    loading: loading,\n    referrerPolicy: referrerPolicy,\n    sizes: sizes,\n    srcSet: srcSet,\n    useMap: useMap,\n    alt: alt,\n    className: cn(\"\".concat(prefixCls, \"-img\"), _defineProperty({}, \"\".concat(prefixCls, \"-img-placeholder\"), placeholder === true), className),\n    style: _objectSpread({\n      height: height\n    }, style)\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", Object.assign({}, otherProps, {\n    className: wrappperClass,\n    onClick: preview && !isError ? onPreview : onClick,\n    style: _objectSpread({\n      width: width,\n      height: height\n    }, wrapperStyle)\n  }), isError && fallback ? /*#__PURE__*/React.createElement(\"img\", Object.assign({}, imgCommonProps, {\n    src: fallback\n  })) : /*#__PURE__*/React.createElement(\"img\", Object.assign({}, imgCommonProps, {\n    onLoad: onLoad,\n    onError: onError,\n    src: src,\n    ref: getImgRef\n  })), status === 'loading' && /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-hidden\": \"true\",\n    className: \"\".concat(prefixCls, \"-placeholder\")\n  }, placeholder)), !isPreviewGroup && preview && !isError && /*#__PURE__*/React.createElement(Preview, {\n    \"aria-hidden\": !isShowPreview,\n    visible: isShowPreview,\n    prefixCls: previewPrefixCls,\n    onClose: onPreviewClose,\n    mousePosition: mousePosition,\n    src: mergedSrc,\n    alt: alt,\n    getContainer: getContainer\n  }));\n};\n\nImageInternal.PreviewGroup = PreviewGroup;\nImageInternal.displayName = 'Image';\nexport default ImageInternal;"]},"metadata":{},"sourceType":"module"}